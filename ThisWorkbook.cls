VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "ThisWorkbook"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True

' Excel 文n打_r的操作
Private Sub Workbook_Open()

    On Error Resume Next

    ''遍v所有模K，K移除不符合l件的已存在模K
    'Dim moduleName
    'moduleName = Array("clsBrowser", "clsCore", "clsJsConverter", "DatabaseDispatchModule", "DatabaseControlPanel", "DatabaseModule", "CrawlerDispatchModule", "CrawlerControlPanel")
    'Dim i As Integer, j As Integer
    'Dim flagBoolean As Boolean
    'flagBoolean = True
    'For i = 1 To ThisWorkbook.VBProject.VBComponents.Count
    '    flagBoolean = True
    '    For j = LBound(moduleName) To UBound(moduleName)
    '        If CStr(ThisWorkbook.VBProject.VBComponents(i).Name) = moduleName(j) Then
    '            flagBoolean = False
    '            Exit For
    '        End If
    '    Next j
    '    If (CStr(ThisWorkbook.VBProject.VBComponents(i).Name) = "ThisWorkbook") Then
    '        flagBoolean = False
    '    End If
    '    For j = 1 To ThisWorkbook.Worksheets.Count
    '        If CStr(ThisWorkbook.VBProject.VBComponents(i).Name) = CStr(ThisWorkbook.Worksheets(j).Name) Then
    '            flagBoolean = False
    '            Exit For
    '        End If
    '    Next j
    '    If flagBoolean Then
    '        'Debug.Print ThisWorkbook.VBProject.VBComponents(i).Name
    '        ThisWorkbook.VBProject.VBComponents.Remove ThisWorkbook.VBProject.VBComponents(i): Rem 移除模K
    '    End If
    'Next i

    'ThisWorkbook.Save

    Call DatabaseDispatchModule.initial  '{用接操控煺{度模M的自定x子^程量初始化x初值
    Call DatabaseDispatchModule.MenuSetup  '{用接操控煺{度模M的自定x子^程建自定x菜

    Call CrawlerDispatchModule.initial  '{用Wj爬x{度模M的自定x子^程量初始化x初值
    Call CrawlerDispatchModule.MenuSetup  '{用Wj爬x{度模M的自定x子^程建自定x菜

End Sub


' Excel 文nP]前的操作
Private Sub Workbook_BeforeClose(Cancel As Boolean)

    On Error Resume Next

    'Call DatabaseDispatchModule.callRemoveModule  '{用接操控煺{度模M的自定x子^程移除清理程序自入的模K
    ''Call DatabaseDispatchModule.callKillProcess  '{用接操控煺{度模M的自定x子^程P]清理程序自建的M程
    ''ThisWorkbook.Save

    'Call CrawlerDispatchModule.callRemoveModule  '{用Wj爬x{度模M的自定x子^程移除清理程序自入的模K
    ''Call CrawlerDispatchModule.callKillProcess  '{用Wj爬x{度模M的自定x子^程P]清理程序自建的M程
    ''ThisWorkbook.Save

    'ThisWorkbook.Save

End Sub

